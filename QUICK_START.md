# âš¡ Quick Start - Hybrid Deployment

Get your bot running on Netlify (webhook) + Railway (worker) in under 10 minutes.

## âœ… **Checklist**

### **1. Netlify Setup (Already Done!)**
- [x] Netlify function created (`netlify/functions/telegram.ts`)
- [x] Netlify config added (`netlify.toml`)
- [x] Deployed to Netlify
- [x] Environment variable `TELEGRAM_BOT_TOKEN` set
- [x] Webhook set to `https://telegram-alpha-bot.netlify.app/webhook`

**Status**: âœ… Webhook is handling user messages

---

### **2. Railway Setup (Next Steps)**

#### **Step 1: Create Railway Project** (2 min)
1. Go to [railway.app/new](https://railway.app/new)
2. Click "Deploy from GitHub repo"
3. Select `telegram-alpha-bot`
4. Click "Add PostgreSQL" to provision a database

#### **Step 2: Set Environment Variables** (2 min)
In Railway â†’ Variables tab, add:
```
TELEGRAM_BOT_TOKEN=<your-bot-token>
DATABASE_URL=<auto-generated-by-railway>
NODE_ENV=production
```

**Optional** (for features):
```
PULSE_CHAT_IDS=<your-chat-id>
PULSE_SYMBOLS=BTC,ETH,SOL,BNB
PULSE_INTERVAL_SEC=900
ADMIN_CHAT_IDS=<your-chat-id>
ALERT_TICK_MS=5000
```

#### **Step 3: Verify Start Command** (1 min)
Railway â†’ Settings â†’ Start Command:
```
npx tsx src/worker.ts
```

#### **Step 4: Deploy** (1 min)
Click "Deploy" and wait for build to complete.

#### **Step 5: Run Database Migrations** (2 min)
Railway â†’ Service â†’ "..." â†’ Terminal:
```bash
npx prisma migrate deploy
```

#### **Step 6: Verify** (1 min)
Check Railway logs for:
```
âœ… All background jobs running
ğŸ’¡ Worker does NOT handle user messages
```

---

## ğŸ§ª **Test Commands**

Send these to your bot on Telegram:

### **Test Netlify (Webhook):**
```
/help
/whoami
/alpha BTC
/margin 1000 10
$ETH
```

### **Test Railway (Worker + DB):**
```
/alert BTC 50000
/alertlist
/watch ETH
/watchlist
```

Wait 15 minutes for automatic market pulse (if `PULSE_CHAT_IDS` is set).

---

## ğŸ“Š **What's Running Where**

| Feature | Netlify | Railway |
|---------|---------|---------|
| User messages | âœ… | âŒ |
| /help, /whoami | âœ… | âŒ |
| Market commands (/alpha, /ema) | âœ… | âŒ |
| Alerts (/alert, /alertlist) | âŒ | âœ… |
| Watchlist (/watch, /watchlist) | âŒ | âœ… |
| Background jobs | âŒ | âœ… |
| Database | âŒ | âœ… |
| Market pulse (auto) | âŒ | âœ… |
| Volatility monitor | âŒ | âœ… |

---

## ğŸ¯ **Success Criteria**

- âœ… Netlify webhook responds to `/help` instantly
- âœ… Railway worker shows "All background jobs running" in logs
- âœ… `/alert BTC 50000` saves alert to database
- âœ… `/alertlist` shows your saved alerts
- âœ… Market pulse messages arrive automatically (every 15 min)
- âœ… No more typing `npm run dev`!

---

## ğŸ”„ **Common Commands**

### **Get your Chat ID:**
```
/whoami
```
(Use this ID for `PULSE_CHAT_IDS` and `ADMIN_CHAT_IDS`)

### **Set an alert:**
```
/alert BTC 50000
/alert ETH 2500 above
/alert SOL 100 below
```

### **View alerts:**
```
/alertlist
```

### **Add to watchlist:**
```
/watch BTC
/watch ETH
```

### **View watchlist:**
```
/watchlist
```

---

## ğŸ› ï¸ **Troubleshooting**

### **"Alerts aren't working"**
1. Check Railway logs for errors
2. Verify `DATABASE_URL` is set
3. Ensure migrations ran: `npx prisma migrate deploy`
4. Check `ALERT_TICK_MS` is set (default: 5000)

### **"Market pulse not sending"**
1. Set `PULSE_CHAT_IDS` to your chat ID (from `/whoami`)
2. Wait 15 minutes (default interval)
3. Check Railway logs for "marketPulse" entries

### **"Commands not responding"**
1. Verify Netlify webhook is set: 
   ```powershell
   Invoke-RestMethod -Uri "https://api.telegram.org/bot<TOKEN>/getWebhookInfo"
   ```
2. Check Netlify function logs
3. Ensure `TELEGRAM_BOT_TOKEN` is set correctly

---

## ğŸ“š **Full Documentation**

For detailed setup instructions, architecture diagrams, and advanced configuration:
- See [RAILWAY_DEPLOY.md](./RAILWAY_DEPLOY.md)

---

## ğŸ‰ **You're All Set!**

Your bot is now running 24/7 without you needing to do anything. Netlify handles user messages, Railway handles background jobs, and you're free to close your terminal! ğŸš€

